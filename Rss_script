-- Hitbox Magnet + GK Save ‚Äî –ø–æ–ª–Ω—ã–π —Å–∫—Ä–∏–ø—Ç
local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

local Window = Rayfield:CreateWindow({
    Name = "RSS | Hitbox Magnet",
    LoadingTitle = "–ó–∞–≥—Ä—É–∑–∫–∞ Hitbox Magnet...",
    LoadingSubtitle = "by ??",
    ConfigurationSaving = { Enabled = false }
})

local Tab = Window:CreateTab("üß≤ Hitbox", 4483362458)
local TabGK = Window:CreateTab("ü•Ö –í—Ä–∞—Ç–∞—Ä—å", 4483362458)

-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏
local Settings = {
    HitboxEnabled = false,
    HitboxRadius = 8,           -- —Ä–∞–¥–∏—É—Å —Ö–∏—Ç–±–æ–∫—Å–∞ (–º–µ—Ç—Ä—ã)
    HitboxStrength = 80,        -- —Å–∏–ª–∞ –ø—Ä–∏—Ç—è–∂–µ–Ω–∏—è (—Å–∫–æ—Ä–æ—Å—Ç—å)
    HitboxUseBodyVelocity = true, -- –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å BodyVelocity –≤–º–µ—Å—Ç–æ –ø—Ä—è–º–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏ AssemblyLinearVelocity
    PerBallCooldown = 0.35,     -- —Å–µ–∫ –º–µ–∂–¥—É —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è–º–∏ –Ω–∞ –æ–¥–∏–Ω –º—è—á
    GKMode = true,              -- –≤–∫–ª—é—á–∏—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ –≤—Ä–∞—Ç–∞—Ä—è (—Å–µ–π–≤ –ø—Ä–∏ —Å–∏–ª—å–Ω–æ–º —É–¥–∞—Ä–µ)
    GK_SaveSpeed = 140,         -- —Å–∫–æ—Ä–æ—Å—Ç—å –æ—Ç–±–∏–≤–∞–Ω–∏—è –ø—Ä–∏ —Å–µ–π–≤–µ
    GK_MinBallSpeed = 15,       -- –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –º—è—á–∞, —á—Ç–æ–±—ã —Å—á–∏—Ç–∞—Ç—å —É–¥–∞—Ä "–æ–ø–∞—Å–Ω—ã–º"
    GK_DotThreshold = 0.7,      -- –Ω–∞—Å–∫–æ–ª—å–∫–æ –ø—Ä—è–º–æ –º—è—á –ª–µ—Ç–∏—Ç –≤ –≤–æ—Ä–æ—Ç–∞ (dot)
    GK_MaxDistanceToAttempt = 18 -- –µ—Å–ª–∏ –∏–≥—Ä–æ–∫ –¥–∞–ª—å—à–µ —ç—Ç–æ–π –¥–∏—Å—Ç–∞–Ω—Ü–∏–∏ –æ—Ç –≤–æ—Ä–æ—Ç, —Ö–∏—Ç–±–æ–∫—Å –≤—ã–ø–æ–ª–Ω–∏—Ç —Å–µ–π–≤
}

-- –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
local RunService = game:GetService("RunService")
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local workspace = game:GetService("Workspace")

local hitboxPart = nil
local goalkeeperZonePart = nil
local perBallLast = {} -- —Ç–∞–±–ª–∏—Ü–∞: [ball] = lastTick
local activeBV = {}    -- —Ç–∞–±–ª–∏—Ü–∞ BodyVelocity –ø–æ –º—è—á—É, —á—Ç–æ–±—ã —É–¥–∞–ª—è—Ç—å
local connection = nil

-- –°–æ–∑–¥–∞—Ç—å/—É–¥–∞–ª–∏—Ç—å —Ö–∏—Ç–±–æ–∫—Å
local function createHitbox()
    if hitboxPart then hitboxPart:Destroy() end
    hitboxPart = Instance.new("Part")
    hitboxPart.Name = "RSS_Hitbox"
    hitboxPart.Anchored = true
    hitboxPart.CanCollide = false
    hitboxPart.Transparency = 1
    hitboxPart.Size = Vector3.new(Settings.HitboxRadius*2, Settings.HitboxRadius*2, Settings.HitboxRadius*2)
    hitboxPart.Shape = Enum.PartType.Ball
    hitboxPart.Parent = workspace
    -- Touched –æ–±—Ä–∞–±–æ—Ç—á–∏–∫
    hitboxPart.Touched:Connect(function(part)
        -- –ø—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —ç—Ç–æ –º—è—á (–∏–º—è —Å–æ–¥–µ—Ä–∂–∏—Ç "ball" –∏–ª–∏ "SoccerBall") –∏ —ç—Ç–æ BasePart
        if not part or not part:IsA("BasePart") then return end
        local name = part.Name:lower()
        if not (name:find("ball") or name:find("soccer")) then return end

        -- debounce –ø–æ –º—è—á—É
        local now = tick()
        local last = perBallLast[part]
        if last and now - last < Settings.PerBallCooldown then return end
        perBallLast[part] = now

        -- –±–µ–∑–æ–ø–∞—Å–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –ø–æ–∑–∏—Ü–∏—é –∏ —Å–∫–æ—Ä–æ—Å—Ç—å
        local ok, vel = pcall(function() return part.AssemblyLinearVelocity end)
        if not ok then vel = Vector3.new(0,0,0) end

        -- –µ—Å–ª–∏ –≤–∫–ª—é—á—ë–Ω —Ä–µ–∂–∏–º –≤—Ä–∞—Ç–∞—Ä—è ‚Äî –ø—Ä–æ–≤–µ—Ä—è–µ–º, –ª–µ—Ç–∏—Ç –ª–∏ –º—è—á –≤ –≤–æ—Ä–æ—Ç–∞
        if Settings.GKMode then
            -- –Ω–∞—Ö–æ–¥–∏–º –±–ª–∏–∂–∞–π—à–∏–π GoalieCenter (–∫–∞–∫ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º —Å–∫—Ä–∏–ø—Ç–µ)
            local function findMyGoal()
                local char = LocalPlayer.Character
                if not char or not char:FindFirstChild("HumanoidRootPart") then return nil end
                local hrp = char.HumanoidRootPart
                local candidates = {}
                local away = workspace:FindFirstChild("AwayPosition")
                local home = workspace:FindFirstChild("HomePosition")
                if away and away:FindFirstChild("GoalieCenter") then table.insert(candidates, away.GoalieCenter) end
                if home and home:FindFirstChild("GoalieCenter") then table.insert(candidates, home.GoalieCenter) end
                if #candidates == 0 then
                    for _, v in pairs(workspace:GetDescendants()) do
                        if v.Name == "GoalieCenter" and v:IsA("BasePart") then table.insert(candidates, v) end
                    end
                end
                local closest, dist = nil, math.huge
                for _, g in pairs(candidates) do
                    local d = (hrp.Position - g.Position).Magnitude
                    if d < dist then dist = d; closest = g end
                end
                return closest, dist
            end

            local myGoal, distToGoal = findMyGoal()
            if myGoal then
                -- –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ç –º—è—á–∞ –∫ –≤–æ—Ä–æ—Ç–∞–º
                local dirToGoal = (myGoal.Position - part.Position)
                if dirToGoal.Magnitude > 0.001 and vel.Magnitude > 0.1 then
                    local ballDir = vel.Unit
                    local dirUnit = dirToGoal.Unit
                    local dot = dirUnit:Dot(ballDir) -- >0 –∑–Ω–∞—á–∏—Ç –ª–µ—Ç–∏—Ç –≤ —Å—Ç–æ—Ä–æ–Ω—É –≤–æ—Ä–æ—Ç
                    -- –µ—Å–ª–∏ –º—è—á –ª–µ—Ç–∏—Ç –≤ –≤–æ—Ä–æ—Ç–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±—ã—Å—Ç—Ä–æ –∏ –ø—Ä—è–º–æ, –∏ –∏–≥—Ä–æ–∫ –¥–∞–ª–µ–∫–æ –æ—Ç –≤–æ—Ä–æ—Ç ‚Äî —Ö–∏—Ç–±–æ–∫—Å –¥–µ–ª–∞–µ—Ç —Å–µ–π–≤
                    local char = LocalPlayer.Character
                    local hrp = char and char:FindFirstChild("HumanoidRootPart")
                    local distPlayerToGoal = hrp and (hrp.Position - myGoal.Position).Magnitude or math.huge
                    if vel.Magnitude >= Settings.GK_MinBallSpeed and dot >= Settings.GK_DotThreshold and distPlayerToGoal > Settings.GK_MaxDistanceToAttempt then
                        -- —Å–µ–π–≤: –æ—Ç–±—Ä–æ—Å–∏—Ç—å –º—è—á –æ—Ç –≤–æ—Ä–æ—Ç
                        local saveDir = (part.Position - myGoal.Position).Unit
                        saveDir = Vector3.new(saveDir.X, 0.35, saveDir.Z).Unit
                        pcall(function()
                            part.AssemblyLinearVelocity = saveDir * Settings.GK_SaveSpeed
                        end)
                        -- —É–¥–∞–ª–∏—Ç—å BV –µ—Å–ª–∏ –±—ã–ª
                        if activeBV[part] then
                            pcall(function() activeBV[part]:Destroy() end)
                            activeBV[part] = nil
                        end
                        -- —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ (–Ω–µ —Å–ø–∞–º–∏–º)
                        if math.random(1,8) == 1 then
                            Rayfield:Notify({Title="ü•Ö Hitbox GK", Content="–°–µ–π–≤ –≤—ã–ø–æ–ª–Ω–µ–Ω —Ö–∏—Ç–±–æ–∫—Å–æ–º", Duration=1})
                        end
                        return
                    end
                end
            end
        end

        -- –û–±—ã—á–Ω–æ–µ –ø—Ä–∏—Ç—è–∂–µ–Ω–∏–µ: –ø—Ä–∏—Ç—è–Ω—É—Ç—å –º—è—á –∫ –∏–≥—Ä–æ–∫—É
        local char = LocalPlayer.Character
        if not char or not char:FindFirstChild("HumanoidRootPart") then return end
        local hrp = char.HumanoidRootPart
        local targetPos = hrp.Position + Vector3.new(0, 1.5, 0) -- —á—É—Ç—å –≤—ã—à–µ –ø–æ–ª–∞

        -- –≤—ã—á–∏—Å–ª—è–µ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏ —Å–∫–æ—Ä–æ—Å—Ç—å
        local dir = (targetPos - part.Position)
        if dir.Magnitude < 0.1 then return end
        local dirUnit = dir.Unit
        local desiredSpeed = Settings.HitboxStrength

        if Settings.HitboxUseBodyVelocity then
            -- —Å–æ–∑–¥–∞—ë–º BodyVelocity –∏ –∑–∞–¥–∞—ë–º —Å–∫–æ—Ä–æ—Å—Ç—å; —Å–æ—Ö—Ä–∞–Ω—è–µ–º, —á—Ç–æ–±—ã —É–¥–∞–ª–∏—Ç—å –ø–æ–∑–∂–µ
            if not part:FindFirstChild("RSS_HitBV") then
                local bv = Instance.new("BodyVelocity")
                bv.Name = "RSS_HitBV"
                bv.MaxForce = Vector3.new(1e5, 1e5, 1e5)
                bv.Velocity = dirUnit * desiredSpeed
                bv.Parent = part
                activeBV[part] = bv
                -- —É–¥–∞–ª—è–µ–º BV —á–µ—Ä–µ–∑ –∫–æ—Ä–æ—Ç–∫–æ–µ –≤—Ä–µ–º—è, —á—Ç–æ–±—ã –Ω–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤–∞—Ç—å —Å —Ñ–∏–∑–∏–∫–æ–π
                delay(0.25, function()
                    if bv and bv.Parent then
                        pcall(function() bv:Destroy() end)
                    end
                    activeBV[part] = nil
                end)
            else
                -- –æ–±–Ω–æ–≤–ª—è–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π
                local bv = part:FindFirstChild("RSS_HitBV")
                if bv then
                    pcall(function() bv.Velocity = dirUnit * desiredSpeed end)
                end
            end
        else
            -- –ø—Ä—è–º–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ AssemblyLinearVelocity –æ–¥–∏–Ω —Ä–∞–∑
            pcall(function()
                part.AssemblyLinearVelocity = dirUnit * desiredSpeed
            end)
        end
    end)
end

local function destroyHitbox()
    if hitboxPart then
        hitboxPart:Destroy()
        hitboxPart = nil
    end
end

-- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏ —Ö–∏—Ç–±–æ–∫—Å–∞ –∫–∞–∂–¥—ã–π –∫–∞–¥—Ä
local function startUpdater()
    if connection then connection:Disconnect() end
    connection = RunService.Heartbeat:Connect(function()
        if not Settings.HitboxEnabled then return end
        if not hitboxPart then createHitbox() end
        local char = LocalPlayer.Character
        if not char or not char:FindFirstChild("HumanoidRootPart") then return end
        local hrp = char.HumanoidRootPart
        hitboxPart.Position = hrp.Position
        hitboxPart.Size = Vector3.new(Settings.HitboxRadius*2, Settings.HitboxRadius*2, Settings.HitboxRadius*2)
    end)
end

local function stopUpdater()
    if connection then connection:Disconnect() connection = nil end
    destroyHitbox()
end

-- UI
Tab:CreateToggle({
    Name = "üß≤ –í–∫–ª—é—á–∏—Ç—å Hitbox",
    CurrentValue = false,
    Callback = function(val)
        Settings.HitboxEnabled = val
        if val then
            createHitbox()
            startUpdater()
            Rayfield:Notify({Title="Hitbox", Content="–í–∫–ª—é—á—ë–Ω", Duration=2})
        else
            stopUpdater()
            Rayfield:Notify({Title="Hitbox", Content="–í—ã–∫–ª—é—á–µ–Ω", Duration=2})
        end
    end
})

Tab:CreateSlider({
    Name = "üìè –†–∞–¥–∏—É—Å —Ö–∏—Ç–±–æ–∫—Å–∞",
    Range = {3, 30},
    Increment = 1,
    CurrentValue = Settings.HitboxRadius,
    Callback = function(v)
        Settings.HitboxRadius = v
        if hitboxPart then hitboxPart.Size = Vector3.new(v*2, v*2, v*2) end
    end
})

Tab:CreateSlider({
    Name = "üí™ –°–∏–ª–∞ –ø—Ä–∏—Ç—è–∂–µ–Ω–∏—è",
    Range = {20, 200},
    Increment = 5,
    CurrentValue = Settings.HitboxStrength,
    Callback = function(v) Settings.HitboxStrength = v end
})

Tab:CreateToggle({
    Name = "üîß –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å BodyVelocity",
    CurrentValue = Settings.HitboxUseBodyVelocity,
    Callback = function(v) Settings.HitboxUseBodyVelocity = v end
})

TabGK:CreateToggle({
    Name = "ü•Ö –†–µ–∂–∏–º –≤—Ä–∞—Ç–∞—Ä—è (GK)",
    CurrentValue = Settings.GKMode,
    Callback = function(v) Settings.GKMode = v end
})

TabGK:CreateSlider({
    Name = "‚ö° –°–∫–æ—Ä–æ—Å—Ç—å –æ—Ç–±–∏–≤–∞–Ω–∏—è (GK)",
    Range = {80, 300},
    Increment = 5,
    CurrentValue = Settings.GK_SaveSpeed,
    Callback = function(v) Settings.GK_SaveSpeed = v end
})

TabGK:CreateSlider({
    Name = "üîé –ú–∏–Ω. —Å–∫–æ—Ä–æ—Å—Ç—å –º—è—á–∞ –¥–ª—è —Å–µ–π–≤–∞",
    Range = {5, 40},
    Increment = 1,
    CurrentValue = Settings.GK_MinBallSpeed,
    Callback = function(v) Settings.GK_MinBallSpeed = v end
})

TabGK:CreateSlider({
    Name = "üéØ –ü–æ—Ä–æ–≥ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è (dot) –¥–ª—è —Å–µ–π–≤–∞",
    Range = {0.4, 0.95},
    Increment = 0.05,
    CurrentValue = Settings.GK_DotThreshold,
    Callback = function(v) Settings.GK_DotThreshold = v end
})

TabGK:CreateSlider({
    Name = "üìè –î–∏—Å—Ç–∞–Ω—Ü–∏—è –¥–æ –≤–æ—Ä–æ—Ç –¥–ª—è –ø–æ–ø—ã—Ç–∫–∏ —Å–µ–π–≤–∞ (–º)",
    Range = {8, 40},
    Increment = 1,
    CurrentValue = Settings.GK_MaxDistanceToAttempt,
    Callback = function(v) Settings.GK_MaxDistanceToAttempt = v end
})

-- –£–¥–∞–ª—è–µ–º BV –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ/–≤—ã–∫–ª—é—á–µ–Ω–∏–∏
game:BindToClose(function()
    for part, bv in pairs(activeBV) do
        pcall(function() if bv and bv.Parent then bv:Destroy() end end)
    end
end)

Rayfield:Notify({Title="‚úÖ Hitbox Magnet –≥–æ—Ç–æ–≤", Content="–í–∫–ª—é—á–∏ Hitbox –∏ –Ω–∞—Å—Ç—Ä–æ–π –ø–∞—Ä–∞–º–µ—Ç—Ä—ã", Duration=4})
